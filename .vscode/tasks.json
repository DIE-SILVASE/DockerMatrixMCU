{
	"version": "2.0.0",
	// "inputs": [
	// 	{
	// 	  "id": "launchTargetID",  // Definir el input para seleccionar la subcarpeta
	// 	  "type": "command",
	// 	  "command": "extension.commandvariable.pickStringRemember",  // Comando para mostrar las opciones
	// 	  "args": {
	// 		"description": "Selecciona la subcarpeta:",
	// 		"default": "microlab_ejemplo",  // Valor por defecto
	// 		"options": [
	// 		  "microlab_ejemplo"  // Las subcarpetas que el usuario puede elegir
	// 		]
	// 	  }
	// 	}
	//   ],
	"tasks": [
		//   {
		// 	"label": "Abrir DevContainer en subcarpeta",
		// 	"type": "shell",
		// 	"command": "code --remote devcontainer+${workspaceFolder}/projects/${input:launchTargetID}#workspace=${workspaceFolder}/projects/${input:launchTargetID}",  // Usar el input para pasar el valor din치mico
		// 	"group": "none",
		// 	"problemMatcher": [],
		// 	"detail": "Abre el devcontainer en una subcarpeta espec칤fica."
		//   },
		//   {  
		// 	"label": "Abrir entorno MatrixMCU",
		// 	"type": "shell",
		// 	"command": "code",
		// 	"args": [
		// 		"--folder-uri",
		// 		"vscode-remote://dev-container+${workspaceFolder}"
		// 	],
		// 	"problemMatcher": [],
		// 	"detail": "Abre directamente el entorno MatrixMCU en DevContainer."
		//   },	 
		{
			"label": "Iniciar MICROLAB",
			"type": "shell",
			"command": "bash",
			"args": [
				"${workspaceFolder}/setup/lab.sh"
			],
			"options": {
				"cwd": "${workspaceFolder}/setup"
			},
			"windows": {
				"command": "powershell",
				"args": [
					"-ExecutionPolicy",
					"Bypass",
					"-File",
					"${workspaceFolder}\\setup\\lab.ps1"
				],
				"options": {
					"cwd": "${workspaceFolder}\\setup"
				},
			},
			"group": "build",
			"problemMatcher": [],
			"detail": "Inicia el entorno de MICROLAB y abre el navegador"
		},
		{
			"label": "Parar MICROLAB",
			"type": "shell",
			"command": "cd ${workspaceFolder}/setup && docker-compose down", // Detiene el entorno del laboratorio
			"windows": {
				"command": "powershell",
				"args": [
					"-ExecutionPolicy",
					"Bypass",
					"-Command",
					"cd ${workspaceFolder}/setup; docker-compose down"
				]
			},
			"group": "build",
			"problemMatcher": [],
			"detail": "Detiene el entorno de MICROLAB."
		},
		{
			"label": "Parar dev-container MatrixMCU",
			"type": "shell",
			"command": "docker stop matrixmcu-dev", // Detiene el contenedor Docker
			"group": "none",
			"problemMatcher": [],
			"detail": "Detiene el contenedor Docker del devcontainer."
		},
		{
			"label": "Eliminar dev-container MatrixMCU",
			"type": "shell",
			"command": "docker rm matrixmcu-dev", // Elimina el contenedor Docker
			"group": "none",
			"problemMatcher": [],
			"detail": "Detiene el contenedor Docker del devcontainer."
		},
		{
			"label": "Build MatrixMCU Environment",
			"type": "shell",
			"command": "bash -c ./build_env.sh",
			"options": {
				"cwd": "${workspaceFolder}/setup"
			},
			"windows": {
				"command": "powershell.exe",
				"args": [
					"-ExecutionPolicy",
					"Bypass",
					"-File",
					"${workspaceFolder}\\setup\\build_env.ps1"
				],
				"options": {
					"cwd": "${workspaceFolder}\\setup"
				},
			},
			"problemMatcher": [],
			"group": {
				"kind": "build",
				"isDefault": false
			},
			"presentation": {
				"echo": true,
				"reveal": "always",
				"focus": false,
				"panel": "shared"
			},
			"detail": "游뚾 SOLO NECESARIO LA PRIMERA VEZ. Construye la imagen personalizada de MatrixMCU para Linux/macOS y descarga las im치genes necesarias del laboratorio."
		},
		{
			"label": "Run OpenOCD", //Si no funciona preuba a lanzarlo mientras pulsas el boton de reset del nucleo
			"type": "shell",
			"command": "openocd", // Aseg칰rate de que openocd est치 en el PATH
			"windows":{
				"command": "C:\\tools\\openocd\\bin\\openocd.exe", //con poner openocd deber칤a servir, siempre que se haya a침adido al path
			},
			"args": [
			  "-f", "interface/stlink.cfg",
			  "-f", "target/stm32f4x.cfg"
			],
			"options": {
			  "cwd": "${workspaceFolder}"
			},
			"isBackground": true,
			"problemMatcher": {
			  "owner": "cortex-debug",
			  "pattern": [{ "regexp": ".+" }],
			  "background": {
				"activeOnStart": true,
				"beginsPattern": "Info : Listening on port 6666",
				"endsPattern": "Info : Listening on port 3333"
			  }
			},
			"presentation": {
			  "reveal": "always",
			  "panel": "dedicated",
			  "clear": true
			}
		},
		{
			"label": "Recargar IP de OpenOCD (Linux)",
			"type": "shell",
			"command": "bash",
			"args": [
			  "-c",
			  "ip r get 1.1.1.1 | grep -oP \"src \\\\K[0-9.]+\" > ./projects/.ip_host_openocd"
			],
			"problemMatcher": []
		}
	]
}
